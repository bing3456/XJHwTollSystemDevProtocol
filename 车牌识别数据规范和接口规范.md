车牌识别通讯接口
===============
# 1.2  车牌照自动识别设备与车道计算机之间通信方式 #
由设备开发商提供相应Linux动态链接库， 车道计算机通过调用相应动态库函数，实现与车牌照自动识别设备间的通讯。动态库函数的接口和返回值遵循本技术规范的要求。
## 1.2.1  数据通信方式规程 ##
车牌照自动识别设备与车道计算机间需要传输数据包括：自动识别的车牌照信息（16byte），车牌照二值化图像数据（280byte），车辆图像数据（500K）。考虑到传输的速率问题，故采用以太网来进行牌照识别设备与车道设备间的数据通讯。
### 1、	与收费车道计算机之间通信物理接口： ###
使用标准以太网接口，使用协议为UDP协议；
###2、	通信速率：###
传输速度：10/100M可选；
###3、传输方式：###
采用自动识别设备主动发送的模式，车道控制计算机被动接受。
###4、端口号###
收费软件监听端 8888  车牌识别动态库与车牌识别通讯端口 5000
###5、数据传输格式约定：###
需要传输的数据包括：自动识别的车牌照信息（16byte），车牌照二值化图像数据（280byte），车辆图像数据（500K），所有传输内容按照字符串进行封装，然后整包发送，各数据字符信息间采用下划线区分，将数据包内容约定如下：

    名称						格式
    数据头					   SOH
    数据包ID号				  ××(2位)0-99之间轮训发送, 不足位前补零
    整个数据包长度			    ××××××（6位）不足位前补零
    是否识别成功				 ×(1位) 0 为识别成功，1为识别失败
    自动识别车牌照信息		   ××××××××××(10位)不足位前补空格
    二值化车牌照信息长度		 ××××××（6位）不足位前补零
    二值化车牌照信息		   ××××…××××
    车辆图像信息长度		   ××××××（6位）不足位前补零
    车辆图像信息				××××…××××
    结束标志				  EOF
    

自动车牌照识别设备在完成一辆车的车牌识别后，通过UDP协议连续向车道控制计算机的5000端口发送相应数据包，直到该设备接受到车道控制计算机的回应数据包，该包格式如下（各数据字符信息间采用下划线区分）：

    名称				格式
    数据头				ACK
    整个数据包长度		 ×××（3位）不足为前补零
    数据包ID号		   ××(2位)0-99之间轮训发送, 不足为前补零
    结束标志	       EOF

自动车牌照识别设备在完成第一辆车的数据传输后，再发送其队列中的其他车牌照识别结果数据，发送方式如第一辆车的模式。

车道计算机按照多次接受的方式进行车牌照识别数据的接受，本规范约定每次接受的包大小为1k byte。并且在完成接受后，对接受到的数据信息进行正确性判断，如果正确，则向车牌照识别设备发送确认回包。

## 1.2.2  Linux共享库（SO）接口定义 ##
### 1.2.2.1消息定义  ###                                                  
 
当下端数据准备好后，会向此端口上发送此UDP包表示有车牌识别数据。
UDP包的格式如下:
> 	名称	 长度（字节）	 内容
> 	数据	 4	         0x01020304

###1.2.2.2接口函数说明  ###             					                    


- 	`BOOL VPR_Init(UINT uPort)`
> 	函数说明           													 
> 	用于初始化系统中的车牌照识别器。
> 	参数			 说明    		                                    
> 	uPort         用户自定义端口，当接口库接收到车牌照识别器的识别结果时，向这个端口发送数据包。
> 	返回值			说明     												      
> 	TRUE       	  初始化牌照识别器成功
> 	FALSE         初始化牌照识别器失败


- `BOOL VPR_Quit()`
> 	函数说明           													
> 	用于关闭系统中的车牌照识别器。
> 	参数			说明    												      
> 	无
> 	返回值			说明    												      
> 	TRUE    	  关闭牌照识别器成功
> 	FALSE		  关闭牌照识别器失败

- `BOOL VPR_Capture ()` 
> 	函数说明           												
> 	向系统中的牌照识别器发送抓拍命令
> 	参数			说明    												      
> 	无
> 	返回值			说明    												      
> 	TRUE       	  发送抓拍命令成功
> 	FALSE         发送抓拍命令失败


-    `BOOL VPR_GetVehicleInfo(
    		char *pchPlate,
    int *piByteBinImagLen,
    		BYTE* pByteBinImage,
    Int *piJpegImageLen,
    		BYTE *pByteJpegImage
    		)`
>     函数说明   												 
>        获取车牌号、车牌二值图、车辆JPEG图象。
>     参数				说明											  
>     pchPlate			返回牌照号
>     piByteBinImagLen	返回车辆二值图的大小
>     pByteBinImage		返回车牌二值图
>     piJpegImageLen		返回车辆JPEG图像的大小
>     pByteJpegImage		返回车辆的图片, 为JPEG格式
>     返回值			      说明												  
>     TRUE		        正确
>     FALSE			    获取信息失败

	1. 	函数返回时，若没有识别结果，pchPlate将返回“无车牌”，pchPlate至少申请30字节的空间。
	2. pByteBinImage至少申请280字节的空间
	3. pByteJpegImage至少申请200*1024字节的空间。


- `int VPR_ComparePlate( int iFullCompare,int iRule, char* chPlateIn,char* chPlateOut)`

> 	函数说明   												 
> 	     比较2个车牌号码字符串
> 	参数			  说明												  
> 	iFullCompare  0值为非整牌比较,iRule值有效,非0值为整牌比较,iRule无效
> 	iRule	      非整牌比较时比较的位数,范围[3-7],汉字作为一个字符比较
> 	chPlateIn     入口车牌号码
> 	chPlateOut    出口车牌号码
> 	返回值			说明												  
> 	0   完全匹配
> 	1   匹配
> 	2   基本匹配
> 	3   不匹配


-   `BOOL VPR_ComparePlateBin( BYTE* lpBinImageIn,BYTE* lpBinImageOut)`
> 	函数说明           												
> 	    比较2个车牌二值化图
> 	参数			 说明    												      
> 	LpBinImageIn  入口车牌二值化图(用户必须申请至少280字节的空间)
> 	lpBinImageOut 出口车牌二值化图(用户必须申请至少280字节的空间)
> 	返回值			说明    												      
> 	TRUE          匹配
> 	FALSE         不匹配


-`    BOOL VPR_CheckStatus(char * chVprDevStatus)`
> 	函数说明           												
> 	检查牌照识别器状态。
> 	参数			     说明    												
> 	chVprDevStatus	   牌照识别器状态说明，返回值
> 	返回值			     说明    												
> 	TRUE               牌照识别器状态正常
> 	FALSE              牌照识别器状态不正常    

